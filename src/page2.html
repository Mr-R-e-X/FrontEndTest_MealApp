<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meals</title>
    <link rel="stylesheet" href="CustomStyles.css">
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-slate-800 text-neutral-400 font-Ubuntu">

    <nav class="flex flex-row justify-between bg-slate-950 mb-5 w-full overflow-hidden">
        <p class="text-3xl text-red-300 font-bold p-2 m-6 tracking-wider">Souvik's Cousin</p>
        <div class="hidden sm:flex m-6 text-2xl  flex-row justify-between w-1/3">
            <div id="home-btn" class="mr-5">
                <button class="w-auto p-2 bg-red-400 text-white text-base rounded-lg">Home</button>
            </div>
            <div class="ml-5 mr-5 text-base">
                <input type="text" placeholder="Search Recipes ..." class="rounded p-2">
            </div>
        </div>
    </nav>
    
    <script>
        const DOCBody = document.body;
        const homeBtn = document.querySelector('#home-btn')
        const dataFromStroage = localStorage.getItem('searchByIngredients');
        const ingredients = localStorage.getItem('ingredient');
        const data = JSON.parse(dataFromStroage)
        console.log(data);
        let mainDiv = document.createElement('div')
        let title = document.createElement('h1');
        mainDiv.classList.add('bg-slate-800', 'text-neutral-400', 'font-Ubuntu', 'fadeIn')
        title.classList.add('transition-all', 'text-xl', 'duration-300', 'ease-in-out', 'text-center', 'hover:text-white')
        title.innerHTML = `The Meals You can get with ${ingredients}`;
        title.classList.add('mb-5', 'p-3');
        mainDiv.append(title);
        DOCBody.appendChild(mainDiv);
        let ingredientsDiv = document.createElement('div');
        ingredientsDiv.classList.add('flex', 'flex-row', 'flex-wrap', 'justify-center', 'align-middle',);
        data.meals.forEach((meal) => {
            // console.log(meal.strMeal)
            let ingredientCard = document.createElement('div');
            ingredientCard.innerHTML = `
                <div class="w-full max-w-52 m-2 transition duration-300 ease-in-out hover:bg-black hover:shadow-lg hover:shadow-white " data='${meal.strMeal}'>
                    <div class="rounded-lg" data='${meal.strMeal}'>
                        <img class="p-2 " src=${meal.strMealThumb} alt="meal image" data='${meal.strMeal}' />
                    </div>
                    <div class="px-1 pb-2" data='${meal.strMeal}'>
                        <h5 class="text-xs text-center font-semibold tracking-tight text-neutral-400 transition duration-300 ease-in-out hover:text-white" data='${meal.strMeal}'> ${meal.strMeal} </h5>
                    </div>
                </div>
            `;
            ingredientsDiv.appendChild(ingredientCard);
        });
        mainDiv.append(ingredientsDiv);
        homeBtn.addEventListener('click', (e)=>{
                e.preventDefault();
                window.location.href = 'index.html';
        });
        document.addEventListener('click', (e)=>{
            console.log(e.target);
            let elem = e.target;
            let mealName = elem.getAttribute('data');
            if(mealName !== null){
                console.log(mealName);
                handleClickMealCard(mealName);
            }
        })
        async function handleClickMealCard(mealName){
            // console.log(mealName)
            let searchByName_url = 'https://www.themealdb.com/api/json/v1/1/search.php?s=' + mealName;
            console.log(searchByName_url)
            let result = await fetch(searchByName_url);
            let data = await result.json();
            let recipe = JSON.stringify(data);
            localStorage.setItem('recipe', recipe);
            localStorage.setItem('recipeName', mealName);
            window.location.href = 'recipe.html';
        }
    </script>
</body>
</html>